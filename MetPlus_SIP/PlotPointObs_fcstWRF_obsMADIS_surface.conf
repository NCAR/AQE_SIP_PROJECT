[config]

# For additional information, please see the METplus Users Guide.
# https://metplus.readthedocs.io/en/latest/Users_Guide

###
# Processes to run
# https://metplus.readthedocs.io/en/latest/Users_Guide/systemconfiguration.html#process-list
###

PROCESS_LIST = PcpCombine, PlotPointObs(TMP), PlotPointObs(RH), PlotPointObs(DPT), PlotPointObs(PSFC)


###
# Time Info
# LOOP_BY options are INIT, VALID, RETRO, and REALTIME
# If set to INIT or RETRO:
#   INIT_TIME_FMT, INIT_BEG, INIT_END, and INIT_INCREMENT must also be set
# If set to VALID or REALTIME:
#   VALID_TIME_FMT, VALID_BEG, VALID_END, and VALID_INCREMENT must also be set
# LEAD_SEQ is the list of forecast leads to process
# https://metplus.readthedocs.io/en/latest/Users_Guide/systemconfiguration.html#timing-control
###

LOOP_BY = VALID
VALID_TIME_FMT = %Y%m%d%H
VALID_BEG = 2022072000
VALID_END = 2022072023
VALID_INCREMENT = 1H

LEAD_SEQ = 0

WRF_DOMAIN = d03

###
# PCPCombine File I/O
# https://metplus.readthedocs.io/en/latest/Users_Guide/systemconfiguration.html#directory-and-filename-template-info
###

FCST_PCP_COMBINE_RUN = True

FCST_PCP_COMBINE_INPUT_DIR = {INPUT_BASE}/WRF
FCST_PCP_COMBINE_INPUT_TEMPLATE = PYTHON_NUMPY

FCST_PCP_COMBINE_OUTPUT_DIR = {OUTPUT_BASE}/WRF_computed
FCST_PCP_COMBINE_OUTPUT_TEMPLATE = wrfout_{WRF_DOMAIN}_{valid?fmt=%Y-%m-%d}_{valid?fmt=%H:%M:%S}


###
# PCPCombine Settings
# https://metplus.readthedocs.io/en/latest/Users_Guide/wrappers.html#pcpcombine
#
###

FCST_PCP_COMBINE_METHOD = USER_DEFINED

FCST_PCP_COMBINE_COMMAND = -add PYTHON_NUMPY -field 'name="{CONF_DIR}/python_scripts/convert_wrf_sfc.py {FCST_PCP_COMBINE_INPUT_DIR}/wrfout_{WRF_DOMAIN}_{valid?fmt=%Y-%m-%d}_{valid?fmt=%H:%M:%S} T2";' -field 'name="{CONF_DIR}/python_scripts/convert_wrf_sfc.py {FCST_PCP_COMBINE_INPUT_DIR}/wrfout_{WRF_DOMAIN}_{valid?fmt=%Y-%m-%d}_{valid?fmt=%H:%M:%S} DPT";' -field 'name="{CONF_DIR}/python_scripts/convert_wrf_sfc.py {FCST_PCP_COMBINE_INPUT_DIR}/wrfout_{WRF_DOMAIN}_{valid?fmt=%Y-%m-%d}_{valid?fmt=%H:%M:%S} RH";' -field 'name="{CONF_DIR}/python_scripts/convert_wrf_sfc.py {FCST_PCP_COMBINE_INPUT_DIR}/wrfout_{WRF_DOMAIN}_{valid?fmt=%Y-%m-%d}_{valid?fmt=%H:%M:%S} PSFC";'


###
# PlotPointObs File I/O
# https://metplus.readthedocs.io/en/latest/Users_Guide/systemconfiguration.html#directory-and-filename-template-info
###

PLOT_POINT_OBS_INPUT_TEMPLATE =PYTHON_NUMPY={CONF_DIR}/python_scripts/convert_madis_sfc_allvars.py {OUTPUT_BASE}/data_ingest/MADIS/metar/{valid?fmt=%Y%m%d_%H%M}.nc

PLOT_POINT_OBS_GRID_INPUT_DIR = {FCST_PCP_COMBINE_OUTPUT_DIR}
PLOT_POINT_OBS_GRID_INPUT_TEMPLATE = wrfout_{WRF_DOMAIN}_{valid?fmt=%Y-%m-%d}_{valid?fmt=%H:%M:%S}

PLOT_POINT_OBS_OUTPUT_DIR = {OUTPUT_BASE}/plots/raw_data

#PLOT_POINT_OBS_SKIP_IF_OUTPUT_EXISTS = False

PLOT_POINT_OBS_RUNTIME_FREQ = RUN_ONCE_FOR_EACH


[TMP]
###
# PlotPointObs Settings for Temperature
# https://metplus.readthedocs.io/en/latest/Users_Guide/wrappers.html#plotpointobs
###

PLOT_POINT_OBS_OUTPUT_TEMPLATE = WRF_MADIS_Temperature_{valid?fmt=%Y%m%d_%H%M%S}.ps

PLOT_POINT_OBS_TITLE = WRF vs MADIS 2m Temperature Valid {valid?fmt=%Y%m%d%H}

PLOT_POINT_OBS_GRID_DATA_FIELD = { name = "T2_Z2"; level = "(*,*)"; convert(x) = K_to_F(x);}
PLOT_POINT_OBS_GRID_DATA_REGRID_TO_GRID = NONE
PLOT_POINT_OBS_GRID_DATA_GRID_PLOT_INFO_COLOR_TABLE = MET_BASE/colortables/met_default.ctable
PLOT_POINT_OBS_GRID_DATA_GRID_PLOT_INFO_PLOT_MIN = 32
PLOT_POINT_OBS_GRID_DATA_GRID_PLOT_INFO_PLOT_MAX = 116

PLOT_POINT_OBS_POINT_DATA =
   {
      msg_typ    = "ADPSFC";
      obs_var    = "temperature";
      convert(x) = K_to_F(x);
      dotsize(x) = 5;
      line_color = [0, 0, 0];
      fill_plot_info = {
         flag          = TRUE;
         color_table   = "MET_BASE/colortables/met_default.ctable";
         plot_min      = 32;
         plot_max      = 116;
         colorbar_flag = FALSE; 
      }
   }


[RH]
###
# PlotPointObs Settings for Relative Humidity
# https://metplus.readthedocs.io/en/latest/Users_Guide/wrappers.html#plotpointobs
###
PLOT_POINT_OBS_OUTPUT_TEMPLATE = WRF_MADIS_RelativeHumidity_{valid?fmt=%Y%m%d_%H%M%S}.ps

PLOT_POINT_OBS_TITLE = WRF vs MADIS 2m Relative Humidity Valid {valid?fmt=%Y%m%d%H}

PLOT_POINT_OBS_GRID_DATA_FIELD = { name = "RH_Z2"; level = "(*,*)"; }
PLOT_POINT_OBS_GRID_DATA_REGRID_TO_GRID = NONE
PLOT_POINT_OBS_GRID_DATA_GRID_PLOT_INFO_COLOR_TABLE = MET_BASE/colortables/NCL_colortables/BlueGreen14.ctable
PLOT_POINT_OBS_GRID_DATA_GRID_PLOT_INFO_PLOT_MIN = 0
PLOT_POINT_OBS_GRID_DATA_GRID_PLOT_INFO_PLOT_MAX = 100

PLOT_POINT_OBS_POINT_DATA =
   {
      msg_typ    = "ADPSFC";
      obs_var    = "RH";
      dotsize(x) = 5;
      line_color = [0, 0, 0];
      fill_plot_info = {
         flag          = TRUE;
         color_table   = "MET_BASE/colortables/NCL_colortables/BlueGreen14.ctable";
         plot_min      = 0;
         plot_max      = 100;
         colorbar_flag = FALSE;
      }
   }


[DPT]
###
# PlotPointObs Settings for Dew Point Temperature
# https://metplus.readthedocs.io/en/latest/Users_Guide/wrappers.html#plotpointobs
###

PLOT_POINT_OBS_OUTPUT_TEMPLATE = WRF_MADIS_DewPointTemperature_{valid?fmt=%Y%m%d_%H%M%S}.ps

PLOT_POINT_OBS_TITLE = WRF vs MADIS 2m Dew Point Temperature Valid {valid?fmt=%Y%m%d%H}

PLOT_POINT_OBS_GRID_DATA_FIELD = { name = "DPT_Z2"; level = "(*,*)"; convert(x) = K_to_F(x);}
PLOT_POINT_OBS_GRID_DATA_REGRID_TO_GRID = NONE
PLOT_POINT_OBS_GRID_DATA_GRID_PLOT_INFO_COLOR_TABLE = MET_BASE/colortables/met_default.ctable
PLOT_POINT_OBS_GRID_DATA_GRID_PLOT_INFO_PLOT_MIN = 0
PLOT_POINT_OBS_GRID_DATA_GRID_PLOT_INFO_PLOT_MAX = 80

PLOT_POINT_OBS_POINT_DATA =
   {
      msg_typ    = "ADPSFC";
      obs_var    = "dewpoint";
      convert(x) = K_to_F(x);
      dotsize(x) = 5;
      line_color = [0, 0, 0];
      fill_plot_info = {
         flag          = TRUE;
         color_table   = "MET_BASE/colortables/met_default.ctable";
         plot_min      = 0;
         plot_max      = 80;
         colorbar_flag = FALSE;
      }
   }


[PSFC]
###
# PlotPointObs Settings for Surface Pressure
# https://metplus.readthedocs.io/en/latest/Users_Guide/wrappers.html#plotpointobs
###

PLOT_POINT_OBS_OUTPUT_TEMPLATE = WRF_MADIS_SurfacePressure_{valid?fmt=%Y%m%d_%H%M%S}.ps

PLOT_POINT_OBS_TITLE = WRF vs MADIS Surface Pressure Valid {valid?fmt=%Y%m%d%H}

PLOT_POINT_OBS_GRID_DATA_FIELD = { name = "PSFC_Z0"; level = "(*,*)";}
PLOT_POINT_OBS_GRID_DATA_REGRID_TO_GRID = NONE
PLOT_POINT_OBS_GRID_DATA_GRID_PLOT_INFO_COLOR_TABLE = MET_BASE/colortables/NCL_colortables/MPL_gist_earth.ctable
PLOT_POINT_OBS_GRID_DATA_GRID_PLOT_INFO_PLOT_MIN = 65000
PLOT_POINT_OBS_GRID_DATA_GRID_PLOT_INFO_PLOT_MAX = 95000

PLOT_POINT_OBS_POINT_DATA =
   {
      msg_typ    = "ADPSFC";
      obs_var    = "PSFC";
      dotsize(x) = 5;
      line_color = [0, 0, 0];
      fill_plot_info = {
         flag          = TRUE;
         color_table   = "MET_BASE/colortables/NCL_colortables/MPL_gist_earth.ctable";
         plot_min      = 65000;
         plot_max      = 95000;
         colorbar_flag = FALSE;
      }
   }
